
<!-- Post Layout Start -->

<!DOCTYPE html>
<html lang="en">

  
<!-- HEAD Start -->

<head>
  


  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Website of Nicolas Six">
  <meta name="author" content="Nicolas Six">
  <meta name="keywords" content="Nicolas, Six">
  <link rel="canonical" href="/traffic-sign-mapping/">
  <title>Nicolas Six | Traffic sign detection and mapping</title>

  <!-- Bootstrap Core CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

  <!-- Custom CSS -->
  <link href="/css/grayscale.css" rel="stylesheet">
  

  <!-- Custom Fonts -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/rrssb.css" />
  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
  
    <link rel="shortcut icon" type="image/x-icon" href="/img/brain_bw_16p.png">
  

  

  


  <!-- iOS Web App mode -->

  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="apple-touch-icon" sizes="36x36" href="/img/web-app/icon-36p.png">
  <link rel="apple-touch-icon" sizes="48x48" href="/img/web-app/icon-48p.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/img/web-app/icon-72p.png">
  <link rel="apple-touch-icon" sizes="96x96" href="/img/web-app/icon-96p.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/img/web-app/icon-144p.png">
  <link rel="apple-touch-icon" sizes="192x192" href="/img/web-app/icon-192p.png">

  <!-- Android Web App mode -->

  <link rel="manifest" href="/manifest.json">




  
<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#000000">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#000000">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">


  


  <!-- Syntax highlight in post pages -->

  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/styles/monokai_sublime.min.css">




</head>

<!-- HEAD End -->


  <body style="background-image:url(/img/sfm.png);background-repeat:no-repeat;background-position: top center;background-size: 100%;">

    
<!-- Navigation Start -->

<nav class="navbar navbar-custom navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse">
        <i class="fa fa-bars"></i>
      </button>
      
        <a class="navbar-brand" href="/">
      
          <div>
            
              <img src="/img/brain_bw_16p.png" alt="">
            
            Nicolas Six
          </div>
        </a>
    </div>
    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse navbar-right navbar-main-collapse">
      <ul class="nav navbar-nav">
        
          <!-- Blog, Post, Tag and Error pages -->
          
            <li>
            
                <a href="/#about"> About </a>
            
            </li>
          
            <li>
            
                <a href="/#timeline"> Education </a>
            
            </li>
          
            <li>
            
                <a href="/#projects"> Projects </a>
            
            </li>
          
            <li>
            
                <a href="/#contact"> Contact </a>
            
            </li>
          
        
      </ul>
    </div>
  </div>
</nav>

<!-- Navigation End -->

<!--     <img style="width:100%;overflow:hidden;" class="project-img" src="/img/sfm.png" alt=""> -->
    
    <section id="post" class="container content-section text-center" style="margin-top:40%;padding-top:30px;background:black;box-shadow: 6px 6px 6px rgba(0,0,0,0.75)">
      
      <div class="row">
        <div class="col-md-10 col-md-offset-1">

          
<!-- Swipe Instructions Start -->

<div id="swipe-instruction">
  <div>
    <p><br><br><br></p>
    <i id="hand-swipe" class="fa fa-hand-o-up"></i>
    <p><strong>
    
      Did you know that you can navigate the posts by swiping left and right?
    
    </strong></p>
    <button type="button" class="btn btn-default ok-btn close-swipe-instruction">
      
        Awesome!
      
    </button>
  </div>
</div>

<!-- Swipe Instructions End -->


          <h1><strong>Traffic sign detection and mapping</strong></h1>
          <iframe src="https://ghbtns.com/github-btn.html?user=anliec&repo=darknet&type=watch&count=true&size=large&v=2" frameborder="0" scrolling="0" width="160px" height="30px"></iframe>
          <iframe src="https://ghbtns.com/github-btn.html?user=anliec&repo=darknet&type=star&count=true&size=large&v=2" frameborder="0" scrolling="0" width="160px" height="30px"></iframe>

          <section class="text-justify" style="margin-top:30px">
            <h3 id="introduction">Introduction</h3>

<p>I worked for <a href="https://www.ce.gatech.edu/node/1001">Dr. Tsai</a> as Graduate Research Assistant (GRA) for 20 months. I spend most of this time working on a sign mapping project for <a href="www.sf-express.com">SF-express</a> and <a href="www.dot.ga.gov">Georgia DOT</a>. As you can imagine this project is a bit large to be described quickly here. Basically for this project I was given a video and a GPS log recorded from a smartphone and I had to produce a map of the traffic sign visible on the video.</p>

<p>To achieve this the process was divided into multiple tasks. The most important of them being: detection, classification, tracking and distance estimation. Multiple student helped me to work on this project, but most of them stayed only for one semester and so at the end I did work on nearly all the different part of the project. In this document I will only mention the work I did myself.</p>

<p>I won’t be able to share with you most of the code for this project, as this code is not publicly available. Some side repository are over available, I will provide link to them when possible.</p>

<h3 id="packaging">Packaging</h3>

<p>One of the main task I had to work on, was to package all the step into one single application for the final delivery. Thanks to my software development background I really enjoyed that task, making it easy to maintain and extend, modular and working on command line or with a UI.</p>

<h3 id="traffic-sign-detection">Traffic sign detection</h3>

<p><img src="/img/yolo_detection.jpg" alt="traffic sign detection example" /></p>

<p>Detection is the most challenging part of this project, getting the highest precision and recall while keeping a low latency was a hard target to reach. Another student did work on this using Faster-RCNN, however this approach was shown to be slow and not very accurate. To solve this issues I decided to switch to Yolo, with a different training strategy.</p>

<p>The training strategy I used here was to split the process in two part, detection and classification. While Yolo can tackle both at the same time, but that require lot of data for training and high resolution images at run time. The difference between a speed limit 60 and 80 is not always easy to see when the image is blurred, even for an human. In addition signs are not common and do you really want to miss speed limit 5, because you do not have example of it in your data?</p>

<p>I choose to divide the sign in super category for training, using there global shape to group them. This allowed me to reduce the input resolution, reduce the class imbalance and improve the global precision and recall. Improving the accuracy also required a lot of work to review at fix the annotations done by other students. A boring and time consuming process.</p>

<p>To ensure the best run time possible I used the <a href="https://github.com/AlexeyAB/darknet">darknet</a> C/C++ library. I wrote a custom runner in C++ using multi-threading to ensure no other task slow the network prediction. Everything was then packaged to be call in Python thanks to CPython.</p>

<p>The modification I made to the code and the configuration file for training, with fine tuned anchors and input size can be found on my <a href="https://github.com/anliec/darknet">fork</a>.</p>

<h3 id="classification">classification</h3>

<p>Classification is less challenging than detection, during this project a classical one shot DNN classifier was used, with satisfying results. However, lot of improvement could be done because of class imbalance or the large number of classes for example. This improvements are part of the <a href="/DL-Trafic-sign-classification/">sign classification project</a>.</p>

<p>Source for training the classification DNN can be found <a href="https://github.com/anliec/Curve-detector">here</a>.</p>

<h3 id="distance-estimation">Distance estimation</h3>

<p>One of the crucial step for an accurate traffic sign mapping is to estimate the distance and direction of the sign from the camera, in order to interpolate the camera’s GPS correctly. To perform this we used several methods, including Structure From Motion (SFM) and visual SLAM that I implemented.</p>

<h4 id="sfm">SFM</h4>

<p><img src="/img/sfm.png" alt="sfm example" /></p>

<p>In this case the goal is to reconstruct a 3D point cloud of the environment around the camera. Then extract the position of the sign by getting the 3D point corresponding to pixels of the sign.</p>

<p>To do that I heavily used <a href="https://github.com/mapillary/OpenSfM">OpenSFM</a> from Mapillary. This allowed me to get high accuracy reconstruction without re-implementing all the algorithm myself. I only needed some pre-processing to generate the right data structure and post processing to extract the results I wanted.</p>

<p>An issue that was encountered is that OpenSFM consider the scene to be static. However, on most of out image there were traffic with moving cars around the camera, leading sometimes to a 3D reconstruction of the car instead of the signs. To prevent that, I use tiny-Yolo, to run a quick vehicle detection on the image, and mask them.</p>

<p>This method is obviously not the most efficient way to achieve this result. However, it was easy to implement and very accurate, much more accurate than the camera GPS in fact. It was then a good base to compare with other methods.</p>

<h4 id="visual-slam">Visual Slam</h4>

<p>In this second case the goal is to use visual SLAM to compute an accurate movement of the camera between the frames and use this plus the position of the sign on the image to deduce the position of the sign.</p>

<p>I relied on <a href="https://github.com/raulmur/ORB_SLAM2">ORBSLAM2</a> for the visual SLAM part and included some C++ code to make it run on our data and interpolate the sign position. This process is much faster than SFM, but still as some drawback. One of them is that as SLAM is designed for real time usage, it does not go back to the previous frame and so may not initialize correctly. Shaky and blur frame can make it loss track.</p>

<p>In conclusion this method is much faster than SFM, but as some inconvenient, while still being very heavy for this task. Simpler approach were also explored by other student, such methods always rely on lot of strong assumptions making the process less accurate at the benefit of negligible run time.</p>

<p>My fork of the ORBSLAM2 repository is available <a href="https://github.com/anliec/ORB_SLAM2">here</a>.</p>

<h3 id="qaqc">Qa/Qc</h3>

<p><img src="/img/qaqc.png" alt="qaqc UI example" /></p>

<p>For this project I also created a tool that compare the results of each steps with the ground truth, to compute accuracy metrics and quickly extract and visualize problematic cases. This tool is build in Python around a basic pyQt UI with some algorithm and SQL request to extract the data.</p>

<p>If this tool was extremely useful in the early days of the project, it became less and less used as the time passed, for a very simple reason, ground truth is expansive and we were not able to afford getting it for new data.</p>

<h3 id="conclusion">Conclusion</h3>

<p>I learned a lot during that project that allowed me to improve on lot of different skills. From software development to machine learning and computer vision. It also give me a lot grounding in what annotating data mean and how painful it can be. It was also for me the occasion to interact directly with the client who is going to use this software, getting to know his very generic request and impossible goals. I also learned a lot from managing this project from end to end and working with new students every semester. Looking back at it was great experience.</p>


          </section>

          
<!-- Share Buttons Start -->
<div>
  <ul class="rrssb-buttons clearfix">
    
    
    
    
    
    
    
    
    
    
  </ul>
</div>

<!-- Share Buttons End -->


          <hr />

          
          <div class="author row">
            <img class="col-xs-4 col-sm-3 col-md-2" src="/img/profile.jpg" alt="Me" />
            <p class="col-xs-8 col-sm-9 col-md-10">
              Nicolas Six is a Computer Science engineer passionate about machine learning and robotic.
            </p>
          </div>
          
        </div>
      </div>
    </section>

    <!-- Footer Start -->

<footer>

    <!-- Social Buttons Start -->

<ul class="list-inline social-buttons">
    
    <li><a href="https://github.com/anliec" target="_blank"><i class="fa fa-github fa-fw"></i></a></li>
    
    <li><a href="https://www.linkedin.com/in/nicolas-six-a1457a112/" target="_blank"><i class="fa fa-linkedin fa-fw"></i></a></li>
    
    <li><a href="mailto:nicolas.six@gatech.edu" target="_blank"><i class="fa fa-envelope fa-fw"></i></a></li>
    
    <li><a href="tel:+1-334-731-8262" target="_blank"><i class="fa fa-phone fa-fw"></i></a></li>
    
    
</ul>

<!-- Social Buttons End -->


    <p><br><br></p>

    <div class="container text-center">
        <p>Copyright &copy; Nicolas Six 2020</p>
        
    </div>
</footer>

<p><br><br><br><br><br><br></p>

<!-- Footer End -->


    
<!-- Javascript Start -->

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

<!-- Plugin JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>

<!-- Custom Theme JavaScript -->
<!--* Start Bootstrap - Grayscale Bootstrap Theme (http://startbootstrap.com)
* Code licensed under the Apache License v2.0.
* For details, see http://www.apache.org/licenses/LICENSE-2.0.-->
<script>
function toggleNavCollapse(){50<$(".navbar").offset().top?$(".navbar-fixed-top").addClass("top-nav-collapse"):$(".navbar-fixed-top").removeClass("top-nav-collapse");}
$(document).ready(toggleNavCollapse);
$(window).scroll(toggleNavCollapse);$(function(){$("a.page-scroll").bind("click",function(b){var a=$(this);$("html, body").stop().animate({scrollTop:$(a.attr("href")).offset().top-50},1500,"easeInOutExpo",function(){a.blur()});b.preventDefault()})});$(".navbar-collapse ul li a").click(function(){$(".navbar-toggle:visible").click()});
</script>





  <!-- Syntax highlight in post pages-->

  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>




  

  <!-- Google Tracking Id Start -->

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', '', 'auto');
    ga('send', 'pageview');
  </script>

  <!-- Google Tracking Id End -->

  




  <!-- Disqus -->

  

    <script type="text/javascript">
    var disqus_shortname = 'personal-jekyll-theme';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>

  

  

    <!-- Comments Counter Start -->

    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'personal-jekyll-theme'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>

    <!-- Comments Counter End -->

  





  <!-- Share buttons Start -->

  <script src="/js/rrssb.min.js"></script>

  <!-- Share buttons End -->





<script>
function addTohistory() {
  if (!window.location.host.startsWith("127.0.0.1")) {
    history.pushState({}, 'Traffic sign detection and mapping', 'https://anliec.github.io//traffic-sign-mapping/');
  }
}
</script>

<!-- Gesture Navigation / Swipe Instruction Start -->


<!-- Javascript End -->


  </body>
</html>

<!-- Post Layout End -->
